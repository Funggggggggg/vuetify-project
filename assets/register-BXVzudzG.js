import{ad as M,ae as B,Y as F,$ as U,X as l,L as o,au as f,ai as v,Z as a,aL as _,as as i,af as $,ag as q,ak as A}from"./index-B1aakBra.js";import{c as N,a as u,f as D,u as E,e as n,V as L}from"./index.esm-c0WZ9xI1.js";import{v as b}from"./index-BTne7ko2.js";import{V as w,a as P,b as x}from"./route-block-m18Oa0ds.js";import{V as R}from"./VDivider-DVKlTu_6.js";import{V as T}from"./VContainer-CzdA3Bnu.js";const O={class:"text-center"},X={__name:"register",setup(Y){const{api:y}=A(),g=M(),k=B(),S=N({account:u().required("api.使用者帳號必填").min(4,"api.使用者帳號太短").max(20,"api.使用者帳號太長").test("isAlphanumeric","api.使用者帳號格式不符",r=>b.isAlphanumeric(r)),email:u().required("api.使用者信箱必填").test("isEmail","api.使用者信箱格式不符",r=>b.isEmail(r)),password:u().required("api.使用者密碼必填").min(4,"api.使用者密碼太短").max(20,"api.使用者密碼太長"),passwordConfirm:u().oneOf([D("password")],"api.密碼不符")}),{handleSubmit:h,isSubmitting:V}=E({validationSchema:S}),m=n("account"),d=n("email"),p=n("password"),c=n("passwordConfirm"),C=h(async r=>{var e,s;try{await y.post("/user",{account:r.account,email:r.email,password:r.password}),g({text:"register.success",snackbarProps:{color:"green"}}),k.push("/login")}catch(t){console.log(t),g({text:"api."+(((s=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:s.message)||"未知錯誤"),snackbarProps:{color:"red"}})}});return(r,e)=>(F(),U(T,null,{default:l(()=>[o(P,null,{default:l(()=>[o(w,{cols:"12"},{default:l(()=>e[4]||(e[4]=[f("h1",{class:"text-center"},v("註冊"),-1)])),_:1}),o(R),o(w,{cols:"12"},{default:l(()=>[o(L,{disabled:a(V),onSubmit:_(a(C),["prevent"])},{default:l(()=>[o(i,{modelValue:a(m).value.value,"onUpdate:modelValue":e[0]||(e[0]=s=>a(m).value.value=s),"error-messages":a(m).errorMessage.value,label:"帳號",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),o(i,{modelValue:a(d).value.value,"onUpdate:modelValue":e[1]||(e[1]=s=>a(d).value.value=s),"error-messages":a(d).errorMessage.value,label:"信箱"},null,8,["modelValue","error-messages"]),o(i,{modelValue:a(p).value.value,"onUpdate:modelValue":e[2]||(e[2]=s=>a(p).value.value=s),type:"password","error-messages":a(p).errorMessage.value,label:"密碼",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),o(i,{modelValue:a(c).value.value,"onUpdate:modelValue":e[3]||(e[3]=s=>a(c).value.value=s),type:"password","error-messages":a(c).errorMessage.value,label:"確認密碼",minlength:"4",maxlength:"20",counter:""},null,8,["modelValue","error-messages"]),f("div",O,[o($,{loading:a(V),type:"submit",color:"primary"},{default:l(()=>e[5]||(e[5]=[q(v("建立帳號"))])),_:1},8,["loading"])])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};typeof x=="function"&&x(X);export{X as default};
