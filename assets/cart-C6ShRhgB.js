import{S as R,ae as S,ad as A,R as I,G as q,c as _,Y as c,$ as f,X as s,L as a,aw as V,ai as l,W as k,_ as z,O as v,af as u,ag as g,aR as D,V as E,aj as j,am as F}from"./index-B_luA4o0.js";import{V as i,a as G,b as h}from"./route-block-BpizlHTn.js";import{V as y}from"./VDivider-BSl-vlf1.js";import{V as O,a as P}from"./VList-DY7Z5Zav.js";import{V as T}from"./VContainer-CaZnrWDT.js";const U={class:"text-center"},W={__name:"cart",setup(X){const{apiAuth:n}=F(),d=R(),C=S(),b=A(),{t:w}=I(),o=q([]),p=async()=>{try{const{data:e}=await n.get("/user/cart");o.value=e.result}catch(e){console.log(e)}};p();const x=_(()=>o.value.reduce((e,r)=>e+r.product.price*r.quantity,0)),B=_(()=>o.value.length>0&&o.value.every(e=>e.product.sell)),m=async(e,r)=>{try{const{data:t}=await n.patch("/user/cart",{product:e,quantity:r});d.cart=t.result,p()}catch(t){console.log(t)}},$=async()=>{var e,r;try{await n.post("/order"),d.cart=0,C.push("/order")}catch(t){console.log(t),b({text:w("api."+(((r=(e=t==null?void 0:t.response)==null?void 0:e.data)==null?void 0:r.message)||"unknownError")),snackbarProps:{color:"red"}})}};return(e,r)=>(c(),f(T,null,{default:s(()=>[a(G,null,{default:s(()=>[a(i,{cols:"12"},{default:s(()=>[V("h1",U,l(e.$t("nav.cart")),1)]),_:1}),a(y),a(i,{cols:"12"},{default:s(()=>[a(O,{lines:"two"},{default:s(()=>[(c(!0),k(v,null,z(o.value,(t,L)=>(c(),k(v,{key:t._id},[a(P,{title:t.product.name,subtitle:t.product.price,"active-class":"bg-red",active:!t.product.sell},{prepend:s(()=>[a(D,{rounded:"0"},{default:s(()=>[a(E,{src:t.product.image},null,8,["src"])]),_:2},1024)]),append:s(()=>[a(u,{color:"red",icon:"mdi-minus",size:"small",class:"ml-2",onClick:N=>m(t.product._id,-1)},null,8,["onClick"]),g(" "+l(t.quantity)+" ",1),a(u,{color:"green",icon:"mdi-plus",size:"small",class:"mr-2",onClick:N=>m(t.product._id,1)},null,8,["onClick"])]),_:2},1032,["title","subtitle","active"]),L<o.value.length-1?(c(),f(y,{key:0})):j("",!0)],64))),128))]),_:1})]),_:1}),a(i,{cols:"12",class:"text-center"},{default:s(()=>[V("p",null,l(x.value),1),a(u,{color:"primary",disabled:!B.value,onClick:$},{default:s(()=>[g(l(e.$t("cart.checkout")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1}))}};typeof h=="function"&&h(W);export{W as default};
